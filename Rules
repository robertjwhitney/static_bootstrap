#!/usr/bin/env ruby

compile '/img/*/' do
end

route '/img/*/' do
  item.identifier.chop + '.' + item[:extension] 
end

compile '/js/*/' do
  case item[:extension]
    when 'js'
      filter :yuicompressor
    when 'min.js'
      #ignore already compressed scripts
  end
end

route '/js/*/' do
  item.identifier.chop + '.' + item[:extension] 
end


compile '/css/*/' do
  filter :sass, :style => :compressed
end

route "/css/lib/*" do
  nil
end

route '/css/*/' do
  item.identifier.chop + '.css'
end

compile '*' do
  case item[:extension]
    when 'txt'
    when '*'
      filter :haml
      layout 'default'
    end
end

route '*' do
  case item[:extension]
    when 'txt'
      item.identifier.chop + '.txt'
    when '*'
      item.identifier + 'index.html'
  end
end

layout '*', :haml, :format => :html5